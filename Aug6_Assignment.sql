CREATE TABLE CUSTOMER(
CUSTOMERID NUMERIC(3) NOT NULL PRIMARY KEY,
CUSTOMERNAME VARCHAR(20) NOT NULL
)

CREATE TABLE CATEGORY(
CATEGORYID NUMERIC(3) NOT NULL PRIMARY KEY,
CATEGORYNAME VARCHAR(20) NOT NULL UNIQUE,
DESCRIPTION VARCHAR(20)
)

CREATE TABLE PRODUCT(
PRODUCTID NUMERIC(3) PRIMARY KEY,
PRODUCTNAME VARCHAR(20) NOT NULL,
CATEGORYID NUMERIC(3) REFERENCES CATEGORY(CATEGORYID),
PRICE NUMERIC(10,2) CHECK(PRICE>50),
QUANTITY NUMERIC(3) CHECK(QUANTITY>0)
)

CREATE TABLE ORDERS(
ORDERYEAR NUMERIC(3),
ORDERMONTH VARCHAR(20),
ORDERID VARCHAR(20),
ORDERDATE DATETIME DEFAULT GETDATE(),
PRODUCTID NUMERIC(3) REFERENCES PRODUCT(PRODUCTID),
CUSTOMERID NUMERIC(3) REFERENCES CUSTOMER(CUSTOMERID),
ORDQRY NUMERIC(3) CHECK(ORDQRY>0),
PRIMARY KEY (ORDERYEAR, ORDERMONTH, ORDERID)
)



ALTER TABLE CUSTOMER ADD ADDRESS VARCHAR(30) CHECK(ADDRESS IN ('MUMBAI','DELHI','PUNE'))

ALTER TABLE ORDERS ALTER COLUMN ORDERYEAR NUMERIC(4)  -->GIVES ERROR
--ERROR-->
--Msg 5074, Level 16, State 1, Line 33
--The object 'PK__ORDERS__29A2FC0F6240BFCB' is dependent on column 'ORDERYEAR'.
--Msg 4922, Level 16, State 9, Line 33
--ALTER TABLE ALTER COLUMN ORDERYEAR failed because one or more objects access this column.

-->SOLUTION
ALTER TABLE ORDERS DROP CONSTRAINT PK__ORDERS__29A2FC0F6240BFCB
  
ALTER TABLE ORDERS ALTER COLUMN ORDERYEAR NUMERIC(4) 

ALTER TABLE ORDERS ADD CONSTRAINT PK_ORDERS PRIMARY KEY(ORDERYEAR, ORDERMONTH, ORDERID)  -->GIVES ERROR

--ERROR-->
--Msg 8111, Level 16, State 1, Line 45
--Cannot define PRIMARY KEY constraint on nullable column in table 'ORDERS'.
--Msg 1750, Level 16, State 0, Line 45
--Could not create constraint or index. See previous errors.

-->SOLUTION
ALTER TABLE ORDERS ALTER COLUMN ORDERYEAR NUMERIC(4) NOT NULL
ALTER TABLE ORDERS ALTER COLUMN ORDERMONTH VARCHAR(20) NOT NULL
ALTER TABLE ORDERS ALTER COLUMN ORDERID VARCHAR(20) NOT NULL

ALTER TABLE ORDERS ADD CONSTRAINT PK_ORDERS PRIMARY KEY(ORDERYEAR, ORDERMONTH, ORDERID)  -->NO ISSUES NOW...COMMAND EXECUTED SUCCESSFULLY

ALTER TABLE ORDERS ALTER COLUMN ORDERMONTH INT NOT NULL  -->GIVES ERROR...SAME AS PREVIOUS

ALTER TABLE ORDERS DROP CONSTRAINT PK_ORDERS  -->SOLUTION

ALTER TABLE ORDERS ALTER COLUMN ORDERMONTH INT NOT NULL

ALTER TABLE ORDERS ADD CONSTRAINT PK_ORDERS PRIMARY KEY(ORDERYEAR, ORDERMONTH, ORDERID)  -->ADD CONSTRAINT AGAIN

ALTER TABLE CATEGORY DROP COLUMN DESCRIPTION




INSERT INTO CUSTOMER VALUES(1,'AJAY','MUMBAI')
INSERT INTO CUSTOMER VALUES(2,'CHIRAG','DELHI')
INSERT INTO CUSTOMER VALUES(3,'AMIT','PUNE')


INSERT INTO CATEGORY VALUES(1,'FOOD')
INSERT INTO CATEGORY VALUES(2,'ELECTRONICS')
INSERT INTO CATEGORY VALUES(3,'STATIONARY')


INSERT INTO PRODUCT VALUES(101,'TEA',1,60,100)
INSERT INTO PRODUCT VALUES(102,'PEN',3,80,50)
INSERT INTO PRODUCT VALUES(103,'NOTE BOOK',3,125,200)
INSERT INTO PRODUCT VALUES(104,'COFFEE',1,80,100)
INSERT INTO PRODUCT VALUES(105,'TV',2,15000,5)
INSERT INTO PRODUCT VALUES(106,'WASHING MACHINE',2,12000,3)


INSERT INTO ORDERS VALUES(2010,1,'1',DEFAULT,101,2,10)
INSERT INTO ORDERS VALUES(2010,1,'2',DEFAULT,104,1,2)
INSERT INTO ORDERS VALUES(2010,2,'1',DEFAULT,105,3,1)
INSERT INTO ORDERS VALUES(2010,2,'2',DEFAULT,101,1,5)
INSERT INTO ORDERS VALUES(2010,2,'3',DEFAULT,106,2,1)
INSERT INTO ORDERS VALUES(2011,1,'1',DEFAULT,104,1,2)


SELECT * FROM ORDERS
SELECT * FROM CATEGORY
SELECT * FROM CUSTOMER
SELECT * FROM PRODUCT


